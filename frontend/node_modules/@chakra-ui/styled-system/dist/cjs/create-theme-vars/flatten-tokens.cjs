'use strict';

var walkObject = require('@chakra-ui/utils/walk-object');
var pseudos = require('../pseudos.cjs');
var themeTokens = require('./theme-tokens.cjs');

function flattenTokens(theme) {
  const tokens = themeTokens.extractTokens(theme);
  const semanticTokens = themeTokens.extractSemanticTokens(theme);
  const pseudoPropNames = pseudos.getPseudoPropNames(theme);
  const isSemanticCondition = (key) => pseudoPropNames.includes(key) || "default" === key;
  const result = {};
  walkObject.walkObject(tokens, (value, path) => {
    if (value == null)
      return;
    result[path.join(".")] = { isSemantic: false, value };
  });
  walkObject.walkObject(
    semanticTokens,
    (value, path) => {
      if (value == null)
        return;
      result[path.join(".")] = { isSemantic: true, value };
    },
    {
      stop: (value) => Object.keys(value).every(isSemanticCondition)
    }
  );
  return result;
}

exports.flattenTokens = flattenTokens;
